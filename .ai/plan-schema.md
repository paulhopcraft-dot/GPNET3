# Plan Schema Requirements

A valid plan MUST include all required sections and follow strict formatting rules.

## Required Sections

### Goal
- **Single sentence** describing the concrete outcome
- **Specific and measurable** - no vague language
- Must start with `## Goal`

### Constraints
- **Explicit "do not" rules** to prevent scope creep
- **Clear boundaries** on what should NOT be done
- Must start with `## Constraints`

### Steps
- **Numbered list** (1. 2. 3. etc.)
- **Each step is executable** - no vague verbs
- **Specific actions** that can be completed
- Must start with `## Steps`

### Done When
- **Binary conditions** that can be verified
- **Testable outcomes** (tests pass, feature works, UI shows X)
- **Clear success criteria**
- Must start with `## Done When`

## Formatting Rules

### Required Structure
```md
# Plan: [Descriptive Title]

## Goal
[Single sentence describing outcome]

## Constraints
- Do not [specific constraint]
- Keep [specific limitation]

## Execution Briefing (Auto-Generated)
üìã TASK SUMMARY: [Goal summary]
üìä WORK BREAKDOWN: [X total steps]
üß† MODEL ALLOCATION: Primary=[MODEL] | OPUS:X SONNET:X HAIKU:X
‚ö° APPROACH: [Complexity-based approach]
üéØ KEY COMMANDS: [Suggested slash commands]
‚è±Ô∏è ESTIMATED SCOPE: [Complexity] - expect [X sessions]
üîç CRITICAL PATHS: [Complex/important steps]

## Steps
1. [MODEL] Specific actionable step description
2. [MODEL] Another specific step description
3. [MODEL] Final specific step description

## Parallel Tasks (Optional)
- task: [task_name]
  steps:
    1. [MODEL] Task-specific step description
    2. [MODEL] Another step description

## Done When
- [Binary testable condition]
- [Another verifiable outcome]
```

**Note:** The Execution Briefing section is automatically generated by the AI execution system to provide context for fresh execution sessions.

### Language Rules

**FORBIDDEN WORDS:**
- "optimize" (too vague)
- "improve" (unmeasurable)
- "clean up" (undefined scope)
- "refactor" (without specific target)
- "enhance" (vague)
- "etc." (incomplete)

**REQUIRED SPECIFICITY:**
- Use concrete verbs: "Add", "Remove", "Create", "Update", "Fix"
- Include specific file paths when possible
- Specify exact UI elements or functionality
- Define measurable success criteria

**MODEL SELECTION GUIDELINES:**
- **[OPUS]**: Complex reasoning, architecture decisions, security analysis
- **[SONNET]**: Balanced tasks, standard implementation, code review
- **[HAIKU]**: Simple coding, UI components, basic tests, quick fixes
- **Direct specification**: Include model in brackets at start of each step
- **Format**: `1. [MODEL] Step description`

## Validation Criteria

A plan is **INVALID** if:
- Missing any required section
- Contains forbidden vague language
- Steps are not numbered
- Steps use unmeasurable language
- "Done When" criteria are subjective
- Goal is not a single sentence
- Constraints are missing or vague

## Examples

### ‚úÖ VALID Plan
```md
# Plan: Add Logout Button

## Goal
Add a logout button to the navigation bar that clears session and redirects to login page.

## Constraints
- Do not modify existing authentication flow
- Do not add confirmation dialogs
- Keep styling consistent with existing nav buttons

## Steps
1. Add logout button component to Navigation.tsx
2. Create handleLogout function to clear localStorage.token
3. Add redirect to /login after logout
4. Update navigation CSS for button styling
5. Add basic test for logout functionality

## Done When
- Logout button appears in navigation bar
- Clicking button clears token and redirects to /login
- Existing tests still pass
- New logout test passes
```

### ‚ùå INVALID Plan
```md
# Improve the app

## Goal
Make the authentication better and clean up the code.

## Steps
1. Optimize the login flow
2. Refactor some components
3. Add improvements
4. etc.

## Done
- Things work better
- Code is cleaner
```

**Invalid because:**
- Vague title and goal
- Uses forbidden words (improve, optimize, refactor, etc.)
- Steps are unmeasurable
- Missing constraints section
- Success criteria are subjective